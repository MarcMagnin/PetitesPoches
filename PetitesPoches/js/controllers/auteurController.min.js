var Auteur=function(){this.Nom="";this.Prenom="";this.Photo="";this.LienBiblio=""},Update=function(){this.Type="";this.Name=""};app.controller("auteurController",function(n,t,i,r,u,f,e){function a(){}var s,l,v,o,h,c;n.entityName="Auteur";n.items=[];n.itemsPool=[];n.tags=[];n.searchItems=[];n.selectedItem="";n.container=$(".tilesContainer");n.dataReady=!1;n.searchPattern="*";n.userLeft=!1;n.$on("tabChanged",function(){n.userLeft=!0});n.init=function(){var t=TweenMax.staggerFrom("md-item",2,{scale:.85,opacity:0,ease:Elastic.easeOut,force3D:!0},.15,onCompleteAll=function(){n.menuShown=!0});TweenMax.to(".progressIndicator",.2,{opacity:1,display:"block"});$(".searchBar").focusin(function(){if(h){$(".searchBar").blur();return}n.toggleSearch()});$(".searchBar").focusout(function(){n.closeSearch()});itemAdded=0;f.getAuteurs().then(function(t){var i=$("#Container");i.mixItUp("isLoaded")&&i.mixItUp("destroy");delayLoop(t,0,0,function(r){n.userLeft&&(t.length=0);r.Id=r["@metadata"]["@id"];r.filter="";r.Nom&&(r.filter+=r.Nom.split(" ").map(function(n){return"f-"+cleanString(n)}).join(" "));r.Prenom&&(r.filter+=" "+r.Prenom.split(" ").map(function(n){return"f-"+cleanString(n)}).join(" "));n.items.push(r);n.items.length==23&&(n.$apply(),i.mixItUp("isLoaded")||i.mixItUp({animation:{enable:enableAnimation}}));n.items.length%30==0&&(n.$apply(),i.mixItUp("isLoaded")&&i.mixItUp("filter",n.searchPattern));n.items.length==t.length&&(n.$apply(),n.dataReady=!0,i.mixItUp("filter",n.searchPattern),TweenMax.to(".progressIndicator",.2,{opacity:0,display:"none"}))})})};n.voirTousSesLivres=function(n){console.log(n);t.$broadcast("goToCollection",n)};s=!1;l=!1;n.toggleSearch=function(){if(!s){s=!0;var n=$(window).width()<630?260:150;$("#searchitem").addClass("toggled");$("#searchIcon").addClass("toggled");TweenMax.fromTo(".searchBar",.2,{width:n+50,opacity:0,ease:null},{width:n,opacity:1,ease:Linear.ease})}};n.closeSearch=function(){var n=$(window).width()<630?260:150;$("#searchitem, #searchIcon, .searchBar").removeClass("toggled");TweenMax.to(".searchBar",.2,{width:n+50,opacity:0,ease:Linear.ease,onComplete:function(){$(".searchBar").width(45)}});s=!1};n.select=function(t,i,r){n.selectedItem=t;$(r.target).closest("a").length||e.show({targetEvent:r,templateUrl:"templates/auteurDialog.tmpl.html",controller:"ModalInstanceCtrl",onComplete:a,locals:{selectedItem:n.selectedItem,parentScope:n}})};v=[];n.searchSuggestionsValue;n.searchSuggestions=function(r){return n.searchSuggestionsValue=r,n.loadingSearchSuggestions=!0,i({method:"GET",url:t.apiRootUrl+"/indexes/AuteurSearchSuggestion",params:{query:"Nom:"+r+"* OR Prenom:"+r+"*",resultsTransformer:"AuteurSearchTransform",pageSize:6,foobar:(new Date).getTime()}}).then(function(t){return n.loadingSearchSuggestions=!1,t.data.Results})};o={key:"text",value:""};n.$watch("searchedText",function(t){n.searchedText&&n.searchItems.indexOf(o)==-1?n.searchItems.push(o):n.searchedText||n.searchItems.splice(n.searchItems.indexOf(o),1);o.value=t});h=!1;n.validateSearchTextBox=function(t){h=!0;setTimeout(function(){h=!1},200);n.searchedText=t.Nom?t.Prenom+" "+t.Nom:t;n.searchPatternRecherche=n.searchedText.length==0?"*":n.searchedText.split(" ").map(function(n){return"[class*='f-"+cleanString(n)+"']"}).join("");n.closeSearch()};n.removeFilter=function(t){n.searchItems.splice(n.searchItems.indexOf(t),1);switch(t.key){case"text":n.searchedText="";n.searchPatternRecherche=null}n.validateFilter()};n.validateFilter=function(){if(n.dataReady){var t=n.searchPatternRecherche?n.searchPatternRecherche:"";n.searchPattern=t.length==0?"*":t;console.log(n.searchPattern);c()}};c=function(){if($("#Container").mixItUp("isLoaded"))if($("#Container").mixItUp("isMixing"))setTimeout(function(){c()},200);else{var t=$("#Container").mixItUp("getState");t.activeFilter!=n.searchPattern&&$("#Container").mixItUp("filter",n.searchPattern)}};n.filtreAuteur=function(t){n.searchedText=t.Prenom+" "+t.Nom;n.validateSearch()};n.validateSearch=function(t){n.searchTimeout&&clearTimeout(n.searchTimeout);t&&t.Nom&&(n.searchedText=t.Prenom+" "+t.Nom);n.searchTimeout=setTimeout(function(){n.searchPatternRecherche=n.searchedText.length==0?"*":n.searchedText.split(" ").map(function(n){return"[class*='f-"+cleanString(n)+"']"}).join("");n.validateFilter()},100)};n.searchAuteurSuggestions=function(r){return n.loadingSearchSuggestions=!0,i({method:"GET",url:t.apiRootUrl+"/indexes/AuteurSearchSuggestion",params:{query:"Nom:"+r+"* OR Prenom:"+r+"*",resultsTransformer:"AuteurSearchTransform",pageSize:10}}).then(function(t){return n.loadingSearchSuggestions=!1,t.data.Results})};n.sort=function(){setTimeout(function(){n.container.isotope({sortBy:"nom"})},100)}});
//# sourceMappingURL=auteurController.min.js.map
